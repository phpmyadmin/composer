{"version":3,"file":"database/events.js","mappings":"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","sources":["webpack://phpmyadmin/./resources/js/database/events.ts","webpack://phpmyadmin/external var \"jQuery\""],"sourcesContent":["import $ from 'jquery';\nimport * as bootstrap from 'bootstrap';\nimport { AJAX } from '../modules/ajax.ts';\nimport { addDatepicker, getSqlEditor, slidingMessage } from '../modules/functions.ts';\nimport { Navigation } from '../modules/navigation.ts';\nimport { ajaxRemoveMessage, ajaxShowMessage } from '../modules/ajax-message.ts';\nimport getJsConfirmCommonParam from '../modules/functions/getJsConfirmCommonParam.ts';\nAJAX.registerTeardown('database/events.js', function () {\n    $(document).off('click', 'a.ajax.add_anchor, a.ajax.edit_anchor');\n    $(document).off('click', 'a.ajax.export_anchor');\n    $(document).off('click', '#bulkActionExportButton');\n    $(document).off('click', 'a.ajax.drop_anchor');\n    $(document).off('click', '#bulkActionDropButton');\n    $(document).off('change', 'select[name=item_type]');\n});\nconst DatabaseEvents = {\n    /**\n     * @var syntaxHiglighter Reference to the codemirror editor\n     */\n    syntaxHiglighter: null,\n    /**\n     * Validate editor form fields.\n     *\n     * @return {boolean}\n     */\n    validate: function () {\n        /**\n         * @var $elm a jQuery object containing the reference\n         *           to an element that is being validated\n         */\n        var $elm = null;\n        // Common validation. At the very least the name\n        // and the definition must be provided for an item\n        $elm = $('table.rte_table').last().find('input[name=item_name]');\n        if ($elm.val() === '') {\n            $elm.trigger('focus');\n            alert(window.Messages.strFormEmpty);\n            return false;\n        }\n        $elm = $('table.rte_table').find('textarea[name=item_definition]');\n        if ($elm.val() === '') {\n            if (this.syntaxHiglighter !== null) {\n                this.syntaxHiglighter.focus();\n            }\n            else {\n                $('textarea[name=item_definition]').last().trigger('focus');\n            }\n            alert(window.Messages.strFormEmpty);\n            return false;\n        }\n        // The validation has so far passed, so now\n        // we can validate item-specific fields.\n        return this.validateCustom();\n    },\n    exportDialog: function ($this) {\n        var $msg = ajaxShowMessage();\n        if ($this.attr('id') === 'bulkActionExportButton') {\n            var combined = {\n                success: true,\n                title: window.Messages.strExport,\n                message: '',\n                error: ''\n            };\n            // export anchors of all selected rows\n            var exportAnchors = $('input.checkall:checked').parents('tr').find('.export_anchor');\n            var count = exportAnchors.length;\n            var returnCount = 0;\n            var p = $.when();\n            exportAnchors.each(function () {\n                var h = $(this).attr('href');\n                p = p.then(function () {\n                    return $.get(h, { 'ajax_request': true }, function (data) {\n                        returnCount++;\n                        if (data.success === true) {\n                            combined.message += '\\n' + data.message + '\\n';\n                            if (returnCount === count) {\n                                showExport(combined);\n                            }\n                        }\n                        else {\n                            // complain even if one export is failing\n                            combined.success = false;\n                            combined.error += '\\n' + data.error + '\\n';\n                            if (returnCount === count) {\n                                showExport(combined);\n                            }\n                        }\n                    });\n                });\n            });\n        }\n        else {\n            $.get($this.attr('href'), { 'ajax_request': true }, showExport);\n        }\n        ajaxRemoveMessage($msg);\n        function showExport(data) {\n            if (data.success !== true) {\n                ajaxShowMessage(data.error, false);\n                return;\n            }\n            ajaxRemoveMessage($msg);\n            const eventsExportTextarea = '<textarea id=\"eventsExportTextarea\" cols=\"40\" rows=\"15\" class=\"form-control\" aria-label=\"' + window.Messages.strEvent + '\"></textarea>';\n            const eventsExportModal = document.getElementById('eventsExportModal');\n            eventsExportModal.addEventListener('shown.bs.modal', function () {\n                eventsExportModal.querySelector('.modal-title').textContent = data.title;\n                eventsExportModal.querySelector('.modal-body').innerHTML = eventsExportTextarea;\n                document.getElementById('eventsExportTextarea').textContent = data.message;\n                getSqlEditor($('#eventsExportTextarea'));\n            });\n            eventsExportModal.addEventListener('hidden.bs.modal', function () {\n                eventsExportModal.querySelector('.modal-body').innerHTML = eventsExportTextarea;\n            });\n            bootstrap.Modal.getOrCreateInstance(eventsExportModal).show();\n        }\n    },\n    editorDialog: function (isNew, $this) {\n        var that = this;\n        /**\n         * @var $edit_row jQuery object containing the reference to\n         *                the row of the the item being edited\n         *                from the list of items\n         */\n        var $editRow = null;\n        if ($this.hasClass('edit_anchor')) {\n            // Remember the row of the item being edited for later,\n            // so that if the edit is successful, we can replace the\n            // row with info about the modified item.\n            $editRow = $this.parents('tr');\n        }\n        /**\n         * @var $msg jQuery object containing the reference to\n         *           the AJAX message shown to the user\n         */\n        var $msg = ajaxShowMessage();\n        $.get($this.attr('href'), { 'ajax_request': true }, function (data) {\n            if (data.success !== true) {\n                ajaxShowMessage(data.error, false);\n                return;\n            }\n            // We have successfully fetched the editor form\n            ajaxRemoveMessage($msg);\n            let isEditMode = false;\n            function eventsEditorModalSaveEventHandler() {\n                // Move the data from the codemirror editor back to the\n                // textarea, where it can be used in the form submission.\n                if (typeof window.CodeMirror !== 'undefined') {\n                    that.syntaxHiglighter.save();\n                }\n                // Validate editor and submit request, if passed.\n                if (that.validate()) {\n                    /**\n                     * @var data Form data to be sent in the AJAX request\n                     */\n                    var data = $('form.rte_form').last().serialize();\n                    $msg = ajaxShowMessage(window.Messages.strProcessingRequest);\n                    var url = $('form.rte_form').last().attr('action');\n                    $.post(url, data, function (data) {\n                        if (data.success !== true) {\n                            ajaxShowMessage(data.error, false);\n                            return;\n                        }\n                        // Item created successfully\n                        ajaxRemoveMessage($msg);\n                        slidingMessage(data.message);\n                        bootstrap.Modal.getOrCreateInstance('#eventsEditorModal').hide();\n                        // If we are in 'edit' mode, we must\n                        // remove the reference to the old row.\n                        if (isEditMode && $editRow !== null) {\n                            $editRow.remove();\n                        }\n                        // Sometimes, like when moving a trigger from\n                        // a table to another one, the new row should\n                        // not be inserted into the list. In this case\n                        // \"data.insert\" will be set to false.\n                        if (data.insert) {\n                            // Insert the new row at the correct\n                            // location in the list of items\n                            /**\n                             * @var text Contains the name of an item from\n                             *           the list that is used in comparisons\n                             *           to find the correct location where\n                             *           to insert a new row.\n                             */\n                            var text = '';\n                            /**\n                             * @var inserted Whether a new item has been\n                             *               inserted in the list or not\n                             */\n                            var inserted = false;\n                            $('table.data').find('tr').each(function () {\n                                text = $(this)\n                                    .children('td')\n                                    .eq(0)\n                                    .find('strong')\n                                    .text()\n                                    .toUpperCase()\n                                    .trim();\n                                if (text !== '' && text > data.name) {\n                                    $(this).before(data.new_row);\n                                    inserted = true;\n                                    return false;\n                                }\n                            });\n                            if (!inserted) {\n                                // If we didn't manage to insert the row yet,\n                                // it must belong at the end of the list,\n                                // so we insert it there.\n                                $('table.data').append(data.new_row);\n                            }\n                            // Fade-in the new row\n                            $('tr.ajaxInsert')\n                                .show('slow')\n                                .removeClass('ajaxInsert');\n                        }\n                        else if ($('table.data').find('tr').has('td').length === 0) {\n                            // If we are not supposed to insert the new row,\n                            // we will now check if the table is empty and\n                            // needs to be hidden. This will be the case if\n                            // we were editing the only item in the list,\n                            // which we removed and will not be inserting\n                            // something else in its place.\n                            $('table.data').hide('slow', function () {\n                                $('#nothing2display').show('slow');\n                            });\n                        }\n                        // Now we have inserted the row at the correct\n                        // position, but surely at least some row classes\n                        // are wrong now. So we will iterate through\n                        // all rows and assign correct classes to them\n                        /**\n                         * @var ct Count of processed rows\n                         */\n                        var ct = 0;\n                        /**\n                         * @var rowclass Class to be attached to the row\n                         *               that is being processed\n                         */\n                        var rowclass = '';\n                        $('table.data').find('tr').has('td').each(function () {\n                            rowclass = (ct % 2 === 0) ? 'odd' : 'even';\n                            $(this).removeClass().addClass(rowclass);\n                            ct++;\n                        });\n                        // If this is the first item being added, remove\n                        // the \"No items\" message and show the list.\n                        if ($('table.data').find('tr').has('td').length > 0 &&\n                            $('#nothing2display').is(':visible')) {\n                            $('#nothing2display').hide('slow', function () {\n                                $('table.data').show('slow');\n                            });\n                        }\n                        Navigation.reload();\n                    });\n                }\n            }\n            const eventsEditorModal = document.getElementById('eventsEditorModal');\n            eventsEditorModal.addEventListener('shown.bs.modal', function () {\n                /**\n                 * Issue #15810 - use button titles for modals (eg: new procedure)\n                 * Respect the order: title on href tag, href content, title sent in response\n                 */\n                eventsEditorModal.querySelector('.modal-title').textContent = $this.attr('title') || $this.text() || $(data.title).text();\n                eventsEditorModal.querySelector('.modal-body').innerHTML = data.message;\n                const eventsEditorModalSaveButton = document.getElementById('eventsEditorModalSaveButton');\n                eventsEditorModalSaveButton?.addEventListener('click', eventsEditorModalSaveEventHandler);\n                $(this).find('input[name=item_name]').trigger('focus');\n                $(this).find('input.datefield').each(function () {\n                    addDatepicker($(this).css('width', '95%'), 'date');\n                });\n                $(this).find('input.datetimefield').each(function () {\n                    addDatepicker($(this).css('width', '95%'), 'datetime');\n                });\n                // @ts-ignore\n                $.datepicker.initialized = false;\n                if ($('input[name=editor_process_edit]').length > 0) {\n                    isEditMode = true;\n                }\n                // Attach syntax highlighted editor to the definition\n                /**\n                 * @var elm jQuery object containing the reference to\n                 *                 the Definition textarea.\n                 */\n                var $elm = $('textarea[name=item_definition]').last();\n                var linterOptions = {\n                    editorType: 'event',\n                };\n                that.syntaxHiglighter = getSqlEditor($elm, {}, 'vertical', linterOptions);\n                window.codeMirrorEditor = that.syntaxHiglighter;\n            });\n            eventsEditorModal.addEventListener('hidden.bs.modal', function () {\n                const eventsEditorModalSaveButton = document.getElementById('eventsEditorModalSaveButton');\n                eventsEditorModalSaveButton?.removeEventListener('click', eventsEditorModalSaveEventHandler);\n                document.getElementById('eventsEditorModal').querySelector('.modal-body').innerHTML = '<div class=\"spinner-border\" role=\"status\">' +\n                    '<span class=\"visually-hidden\">' + window.Messages.strLoading + '</span></div>';\n            });\n            bootstrap.Modal.getOrCreateInstance(eventsEditorModal).show();\n        });\n    },\n    dropDialog: function ($this) {\n        /**\n         * @var $curr_row Object containing reference to the current row\n         */\n        var $currRow = $this.parents('tr');\n        /**\n         * @var question String containing the question to be asked for confirmation\n         */\n        var question = $('<div></div>').text($currRow.children('td').children('.drop_sql').html());\n        // We ask for confirmation first here, before submitting the ajax request\n        $this.confirm(question, $this.attr('href'), function (url) {\n            /**\n             * @var msg jQuery object containing the reference to\n             *          the AJAX message shown to the user\n             */\n            var $msg = ajaxShowMessage(window.Messages.strProcessingRequest);\n            var params = getJsConfirmCommonParam(this, $this.getPostData());\n            $.post(url, params, function (data) {\n                if (data.success !== true) {\n                    ajaxShowMessage(data.error, false);\n                    return;\n                }\n                /**\n                 * @var $table Object containing reference\n                 *             to the main list of elements\n                 */\n                var $table = $currRow.parent();\n                // Check how many rows will be left after we remove\n                // the one that the user has requested us to remove\n                if ($table.find('tr').length === 3) {\n                    // If there are two rows left, it means that they are\n                    // the header of the table and the rows that we are\n                    // about to remove, so after the removal there will be\n                    // nothing to show in the table, so we hide it.\n                    $table.hide('slow', function () {\n                        $(this).find('tr.even, tr.odd').remove();\n                        $('.withSelected').remove();\n                        $('#nothing2display').show('slow');\n                    });\n                }\n                else {\n                    $currRow.hide('slow', function () {\n                        $(this).remove();\n                        // Now we have removed the row from the list, but maybe\n                        // some row classes are wrong now. So we will iterate\n                        // through all rows and assign correct classes to them.\n                        /**\n                         * @var ct Count of processed rows\n                         */\n                        var ct = 0;\n                        /**\n                         * @var rowclass Class to be attached to the row\n                         *               that is being processed\n                         */\n                        var rowclass = '';\n                        $table.find('tr').has('td').each(function () {\n                            rowclass = (ct % 2 === 1) ? 'odd' : 'even';\n                            $(this).removeClass().addClass(rowclass);\n                            ct++;\n                        });\n                    });\n                }\n                // Get rid of the \"Loading\" message\n                ajaxRemoveMessage($msg);\n                // Show the query that we just executed\n                slidingMessage(data.sql_query);\n                Navigation.reload();\n            }); // end $.post()\n        });\n    },\n    dropMultipleDialog: function ($this) {\n        // We ask for confirmation here\n        $this.confirm(window.Messages.strDropRTEitems, '', function () {\n            /**\n             * @var msg jQuery object containing the reference to\n             *          the AJAX message shown to the user\n             */\n            var $msg = ajaxShowMessage(window.Messages.strProcessingRequest);\n            // drop anchors of all selected rows\n            var dropAnchors = $('input.checkall:checked').parents('tr').find('.drop_anchor');\n            var success = true;\n            var count = dropAnchors.length;\n            var returnCount = 0;\n            dropAnchors.each(function () {\n                var $anchor = $(this);\n                /**\n                 * @var $curr_row Object containing reference to the current row\n                 */\n                var $currRow = $anchor.parents('tr');\n                var params = getJsConfirmCommonParam(this, $anchor.getPostData());\n                $.post($anchor.attr('href'), params, function (data) {\n                    returnCount++;\n                    if (data.success !== true) {\n                        ajaxShowMessage(data.error, false);\n                        success = false;\n                        if (returnCount === count) {\n                            Navigation.reload();\n                        }\n                        return;\n                    }\n                    /**\n                     * @var $table Object containing reference\n                     *             to the main list of elements\n                     */\n                    var $table = $currRow.parent();\n                    // Check how many rows will be left after we remove\n                    // the one that the user has requested us to remove\n                    if ($table.find('tr').length === 3) {\n                        // If there are two rows left, it means that they are\n                        // the header of the table and the rows that we are\n                        // about to remove, so after the removal there will be\n                        // nothing to show in the table, so we hide it.\n                        $table.hide('slow', function () {\n                            $(this).find('tr.even, tr.odd').remove();\n                            $('.withSelected').remove();\n                            $('#nothing2display').show('slow');\n                        });\n                    }\n                    else {\n                        $currRow.hide('fast', function () {\n                            // we will iterate\n                            // through all rows and assign correct classes to them.\n                            /**\n                             * @var ct Count of processed rows\n                             */\n                            var ct = 0;\n                            /**\n                             * @var rowclass Class to be attached to the row\n                             *               that is being processed\n                             */\n                            var rowclass = '';\n                            $table.find('tr').has('td').each(function () {\n                                rowclass = (ct % 2 === 1) ? 'odd' : 'even';\n                                $(this).removeClass().addClass(rowclass);\n                                ct++;\n                            });\n                        });\n                        $currRow.remove();\n                    }\n                    if (returnCount === count) {\n                        if (success) {\n                            // Get rid of the \"Loading\" message\n                            ajaxRemoveMessage($msg);\n                            $('#rteListForm_checkall').prop({ checked: false, indeterminate: false });\n                        }\n                        Navigation.reload();\n                    }\n                }); // end $.post()\n            }); // end drop_anchors.each()\n        });\n    },\n    /**\n     * Validate custom editor form fields.\n     *\n     * @return {boolean}\n     */\n    validateCustom: function () {\n        /**\n         * @var elm a jQuery object containing the reference\n         *          to an element that is being validated\n         */\n        var $elm = null;\n        const eventsEditorModal = $('#eventsEditorModal');\n        if (eventsEditorModal.find('select[name=item_type]').find(':selected').val() === 'RECURRING') {\n            // The interval field must not be empty for recurring events\n            $elm = eventsEditorModal.find('input[name=item_interval_value]');\n            if ($elm.val() === '') {\n                $elm.trigger('focus');\n                alert(window.Messages.strFormEmpty);\n                return false;\n            }\n        }\n        else {\n            // The execute_at field must not be empty for \"once off\" events\n            $elm = eventsEditorModal.find('input[name=item_execute_at]');\n            if ($elm.val() === '') {\n                $elm.trigger('focus');\n                alert(window.Messages.strFormEmpty);\n                return false;\n            }\n        }\n        return true;\n    }\n};\nAJAX.registerOnload('database/events.js', function () {\n    /**\n     * Attach Ajax event handlers for the Add/Edit functionality.\n     */\n    $(document).on('click', 'a.ajax.add_anchor, a.ajax.edit_anchor', function (event) {\n        event.preventDefault();\n        if ($(this).hasClass('add_anchor')) {\n            // @ts-ignore\n            $.datepicker.initialized = false;\n        }\n        DatabaseEvents.editorDialog($(this).hasClass('add_anchor'), $(this));\n    });\n    /**\n     * Attach Ajax event handlers for Export\n     */\n    $(document).on('click', 'a.ajax.export_anchor', function (event) {\n        event.preventDefault();\n        DatabaseEvents.exportDialog($(this));\n    }); // end $(document).on()\n    $(document).on('click', '#bulkActionExportButton', function (event) {\n        event.preventDefault();\n        DatabaseEvents.exportDialog($(this));\n    }); // end $(document).on()\n    /**\n     * Attach Ajax event handlers for Drop functionality\n     */\n    $(document).on('click', 'a.ajax.drop_anchor', function (event) {\n        event.preventDefault();\n        DatabaseEvents.dropDialog($(this));\n    }); // end $(document).on()\n    $(document).on('click', '#bulkActionDropButton', function (event) {\n        event.preventDefault();\n        DatabaseEvents.dropMultipleDialog($(this));\n    }); // end $(document).on()\n    /**\n     * Attach Ajax event handlers for the \"Change event type\" functionality, so that the correct\n     * rows are shown in the editor when changing the event type\n     */\n    $(document).on('change', 'select[name=item_type]', function () {\n        $(this).closest('table').find('tr.recurring_event_row, tr.onetime_event_row').toggle();\n    });\n});\n","module.exports = jQuery;"],"names":["$","bootstrap","AJAX","addDatepicker","getSqlEditor","slidingMessage","Navigation","ajaxRemoveMessage","ajaxShowMessage","getJsConfirmCommonParam","registerTeardown","document","off","DatabaseEvents","syntaxHiglighter","validate","$elm","last","find","val","trigger","alert","window","Messages","strFormEmpty","focus","validateCustom","exportDialog","$this","$msg","attr","combined","success","title","strExport","message","error","exportAnchors","parents","count","length","returnCount","p","when","each","h","then","get","data","showExport","eventsExportTextarea","strEvent","eventsExportModal","getElementById","addEventListener","querySelector","textContent","innerHTML","Modal","getOrCreateInstance","show","editorDialog","isNew","that","$editRow","hasClass","isEditMode","eventsEditorModalSaveEventHandler","CodeMirror","save","serialize","strProcessingRequest","url","post","hide","remove","insert","text","inserted","children","eq","toUpperCase","trim","name","before","new_row","append","removeClass","has","ct","rowclass","addClass","is","reload","eventsEditorModal","eventsEditorModalSaveButton","css","datepicker","initialized","linterOptions","editorType","codeMirrorEditor","removeEventListener","strLoading","dropDialog","$currRow","question","html","confirm","params","getPostData","$table","parent","sql_query","dropMultipleDialog","strDropRTEitems","dropAnchors","$anchor","prop","checked","indeterminate","registerOnload","on","event","preventDefault","closest","toggle"],"sourceRoot":""}