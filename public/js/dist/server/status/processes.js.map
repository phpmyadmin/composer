{"version":3,"file":"server/status/processes.js","mappings":";;;;;;AAAA;;;;;;;;;;;;;;;;ACAuB;AACsB;AACU;AACG;AACM;AACD;AACE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,IAAIO,WAAW,GAAG;EACd;EACAC,WAAW,EAAE,KAAK;EAClB;EACAC,cAAc,EAAE,IAAI;EACpB;EACAC,cAAc,EAAE,IAAI;EACpB;EACAC,eAAe,EAAE,IAAI;EACrB;EACA;EACAC,UAAU,EAAE,IAAI;EAChB;AACJ;AACA;EACIC,IAAI,EAAE,SAAAA,CAAA,EAAY;IACdN,WAAW,CAACO,eAAe,CAAC,CAAC;IAC7B,IAAIP,WAAW,CAACK,UAAU,KAAK,IAAI,EAAE;MACjCL,WAAW,CAACK,UAAU,GAAG,kDAAkD;IAC/E;IACA,IAAIL,WAAW,CAACI,eAAe,KAAK,IAAI,EAAE;MACtCJ,WAAW,CAACI,eAAe,GAAGX,6CAAC,CAAC,iBAAiB,CAAC,CAACe,GAAG,CAAC,CAAC;IAC5D,CAAC,MACI;MACDf,6CAAC,CAAC,iBAAiB,CAAC,CAACe,GAAG,CAACR,WAAW,CAACI,eAAe,CAAC;IACzD;EACJ,CAAC;EACD;AACJ;AACA;AACA;AACA;EACIK,kBAAkB,EAAE,SAAAA,CAAUC,KAAK,EAAE;IACjCA,KAAK,CAACC,cAAc,CAAC,CAAC;IACtB,IAAIC,MAAM,GAAGjB,4DAAY,CAACkB,GAAG,CAAC,eAAe,CAAC;IAC9C,IAAIC,MAAM,GAAGrB,6CAAC,CAAC,IAAI,CAAC,CAACsB,WAAW,CAAC,CAAC;IAClCD,MAAM,IAAIF,MAAM,GAAG,gBAAgB,GAAGA,MAAM,GAAG,SAAS,GAAGjB,4DAAY,CAACkB,GAAG,CAAC,QAAQ,CAAC;IACrF;IACA,IAAIG,GAAG,GAAGvB,6CAAC,CAAC,IAAI,CAAC,CAACwB,OAAO,CAAC,IAAI,CAAC;IAC/BxB,kDAAM,CAACA,6CAAC,CAAC,IAAI,CAAC,CAAC0B,IAAI,CAAC,MAAM,CAAC,EAAEL,MAAM,EAAE,UAAUM,IAAI,EAAE;MACjD;MACA,IAAIA,IAAI,CAACC,cAAc,CAAC,SAAS,CAAC,IAAID,IAAI,CAACE,OAAO,EAAE;QAChD;QACAN,GAAG,CAACO,MAAM,CAAC,CAAC;QACZ;QACA;QACA,IAAIC,mBAAmB,GAAG/B,6CAAC,CAAC,mBAAmB,CAAC,CAACgC,IAAI,CAAC,cAAc,CAAC;QACrED,mBAAmB,CAACE,IAAI,CAAC,UAAUC,KAAK,EAAE;UACtC,IAAIA,KAAK,IAAI,CAAC,IAAIA,KAAK,GAAG,CAAC,KAAK,CAAC,EAAE;YAC/BlC,6CAAC,CAAC,IAAI,CAAC,CAACmC,WAAW,CAAC,KAAK,CAAC,CAACC,QAAQ,CAAC,MAAM,CAAC;UAC/C,CAAC,MACI,IAAIF,KAAK,IAAI,CAAC,IAAIA,KAAK,GAAG,CAAC,KAAK,CAAC,EAAE;YACpClC,6CAAC,CAAC,IAAI,CAAC,CAACmC,WAAW,CAAC,MAAM,CAAC,CAACC,QAAQ,CAAC,KAAK,CAAC;UAC/C;QACJ,CAAC,CAAC;QACF;QACAhC,yEAAe,CAACuB,IAAI,CAACU,OAAO,EAAE,KAAK,CAAC;MACxC,CAAC,MACI;QACD;QACAjC,yEAAe,CAACuB,IAAI,CAACW,KAAK,EAAE,KAAK,CAAC;MACtC;IACJ,CAAC,EAAE,MAAM,CAAC;EACd,CAAC;EACD;AACJ;AACA;EACIC,OAAO,EAAE,SAAAA,CAAA,EAAY;IACjB;IACA;IACA;IACA;IACAhC,WAAW,CAACiC,YAAY,CAAC,CAAC;IAC1B;IACA,IAAIjC,WAAW,CAACC,WAAW,EAAE;MACzB;MACAD,WAAW,CAACK,UAAU,GAAG,kDAAkD;MAC3E,IAAI6B,QAAQ,GAAGC,QAAQ,CAACnC,WAAW,CAACI,eAAe,EAAE,EAAE,CAAC,GAAG,IAAI;MAC/D,IAAIgC,SAAS,GAAGpC,WAAW,CAACqC,YAAY,CAAC,CAAC;MAC1CrC,WAAW,CAACE,cAAc,GAAGT,kDAAM,CAACO,WAAW,CAACK,UAAU,EAAE+B,SAAS,EAAE,UAAUhB,IAAI,EAAE;QACnF,IAAIA,IAAI,CAACC,cAAc,CAAC,SAAS,CAAC,IAAID,IAAI,CAACE,OAAO,EAAE;UAChD,IAAIgB,SAAS,GAAG7C,6CAAC,CAAC2B,IAAI,CAACU,OAAO,CAAC;UAC/BrC,6CAAC,CAAC,mBAAmB,CAAC,CAAC8C,IAAI,CAACD,SAAS,CAACC,IAAI,CAAC,CAAC,CAAC;UAC7C3C,qEAAY,CAACH,6CAAC,CAAC,mBAAmB,CAAC,CAAC;QACxC;QACAO,WAAW,CAACG,cAAc,GAAGqC,UAAU,CAACxC,WAAW,CAACgC,OAAO,EAAEE,QAAQ,CAAC;MAC1E,CAAC,CAAC;IACN;EACJ,CAAC;EACD;AACJ;AACA;EACID,YAAY,EAAE,SAAAA,CAAA,EAAY;IACtB,IAAIjC,WAAW,CAACE,cAAc,KAAK,IAAI,EAAE;MACrCF,WAAW,CAACE,cAAc,CAACuC,KAAK,CAAC,CAAC;MAClCzC,WAAW,CAACE,cAAc,GAAG,IAAI;IACrC;IACAwC,YAAY,CAAC1C,WAAW,CAACG,cAAc,CAAC;EAC5C,CAAC;EACD;AACJ;AACA;AACA;EACII,eAAe,EAAE,SAAAA,CAAA,EAAY;IACzB,IAAIoC,GAAG,GAAG,MAAM;IAChB,IAAIC,KAAK,GAAGC,MAAM,CAACC,QAAQ,CAACC,eAAe;IAC3C,IAAI/C,WAAW,CAACC,WAAW,EAAE;MACzB0C,GAAG,GAAG,OAAO;MACbC,KAAK,GAAGC,MAAM,CAACC,QAAQ,CAACE,cAAc;MACtChD,WAAW,CAACgC,OAAO,CAAC,CAAC;IACzB;IACAvC,6CAAC,CAAC,iBAAiB,CAAC,CAAC8C,IAAI,CAACxC,6EAAW,CAAC4C,GAAG,CAAC,GAAG7C,wEAAU,CAAC8C,KAAK,CAAC,CAAC;EACnE,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;AACA;EACIP,YAAY,EAAE,SAAAA,CAAA,EAAY;IACtB,IAAID,SAAS,GAAG;MACZ,QAAQ,EAAEzC,4DAAY,CAACkB,GAAG,CAAC,QAAQ,CAAC;MACpC,cAAc,EAAE,IAAI;MACpB,SAAS,EAAE,IAAI;MACf,MAAM,EAAEpB,6CAAC,CAAC,oBAAoB,CAAC,CAACe,GAAG,CAAC,CAAC;MACrC,gBAAgB,EAAEf,6CAAC,CAAC,8BAA8B,CAAC,CAACe,GAAG,CAAC,CAAC;MACzD,aAAa,EAAEf,6CAAC,CAAC,2BAA2B,CAAC,CAACe,GAAG,CAAC,CAAC;MACnD,YAAY,EAAEf,6CAAC,CAAC,0BAA0B,CAAC,CAACe,GAAG,CAAC;IACpD,CAAC;IACD,IAAIf,6CAAC,CAAC,gBAAgB,CAAC,CAACwD,EAAE,CAAC,UAAU,CAAC,EAAE;MACpCb,SAAS,CAACc,aAAa,GAAG,IAAI;MAC9B,OAAOd,SAAS;IACpB;IACA,OAAOA,SAAS;EACpB;AACJ,CAAC;AACD1C,kDAAI,CAACyD,cAAc,CAAC,4BAA4B,EAAE,YAAY;EAC1DnD,WAAW,CAACM,IAAI,CAAC,CAAC;EAClB;EACAb,6CAAC,CAAC,mBAAmB,CAAC,CAAC2D,EAAE,CAAC,OAAO,EAAE,gBAAgB,EAAEpD,WAAW,CAACS,kBAAkB,CAAC;EACpF;EACAhB,6CAAC,CAAC,iBAAiB,CAAC,CAAC2D,EAAE,CAAC,OAAO,EAAE,UAAU1C,KAAK,EAAE;IAC9CA,KAAK,CAACC,cAAc,CAAC,CAAC;IACtBX,WAAW,CAACC,WAAW,GAAG,CAACD,WAAW,CAACC,WAAW;IAClDD,WAAW,CAACO,eAAe,CAAC,CAAC;EACjC,CAAC,CAAC;EACF;EACAd,6CAAC,CAAC,iBAAiB,CAAC,CAAC2D,EAAE,CAAC,QAAQ,EAAE,YAAY;IAC1CpD,WAAW,CAACI,eAAe,GAAGX,6CAAC,CAAC,IAAI,CAAC,CAACe,GAAG,CAAC,CAAC;IAC3CR,WAAW,CAACgC,OAAO,CAAC,CAAC;EACzB,CAAC,CAAC;EACF;EACAvC,6CAAC,CAAC,mBAAmB,CAAC,CAAC2D,EAAE,CAAC,OAAO,EAAE,SAAS,EAAE,YAAY;IACtDpD,WAAW,CAACK,UAAU,GAAGZ,6CAAC,CAAC,IAAI,CAAC,CAAC0B,IAAI,CAAC,MAAM,CAAC;EACjD,CAAC,CAAC;AACN,CAAC,CAAC;AACF;AACA;AACA;AACAzB,kDAAI,CAAC2D,gBAAgB,CAAC,4BAA4B,EAAE,YAAY;EAC5D5D,6CAAC,CAAC,mBAAmB,CAAC,CAAC6D,GAAG,CAAC,OAAO,EAAE,gBAAgB,CAAC;EACrD7D,6CAAC,CAAC,iBAAiB,CAAC,CAAC6D,GAAG,CAAC,OAAO,CAAC;EACjC7D,6CAAC,CAAC,iBAAiB,CAAC,CAAC6D,GAAG,CAAC,QAAQ,CAAC;EAClC7D,6CAAC,CAAC,mBAAmB,CAAC,CAAC6D,GAAG,CAAC,OAAO,EAAE,SAAS,CAAC;EAC9C;EACAtD,WAAW,CAACiC,YAAY,CAAC,CAAC;AAC9B,CAAC,CAAC","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./resources/js/src/server/status/processes.ts"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../../modules/ajax.ts';\nimport { CommonParams } from '../../modules/common.ts';\nimport highlightSql from '../../modules/sql-highlight.ts';\nimport { ajaxShowMessage } from '../../modules/ajax-message.ts';\nimport { escapeHtml } from '../../modules/functions/escape.ts';\nimport getImageTag from '../../modules/functions/getImageTag.ts';\n/**\n * Server Status Processes\n *\n * @package PhpMyAdmin\n */\n// object to store process list state information\nvar processList = {\n    // denotes whether auto refresh is on or off\n    autoRefresh: false,\n    // stores the GET request which refresh process list\n    refreshRequest: null,\n    // stores the timeout id returned by setTimeout\n    refreshTimeout: null,\n    // the refresh interval in seconds\n    refreshInterval: null,\n    // the refresh URL (required to save last used option)\n    // i.e. full or sorting url\n    refreshUrl: null,\n    /**\n     * Handles killing of a process\n     */\n    init: function () {\n        processList.setRefreshLabel();\n        if (processList.refreshUrl === null) {\n            processList.refreshUrl = 'index.php?route=/server/status/processes/refresh';\n        }\n        if (processList.refreshInterval === null) {\n            processList.refreshInterval = $('#id_refreshRate').val();\n        }\n        else {\n            $('#id_refreshRate').val(processList.refreshInterval);\n        }\n    },\n    /**\n     * Handles killing of a process\n     *\n     * @param {object} event the event object\n     */\n    killProcessHandler: function (event) {\n        event.preventDefault();\n        var argSep = CommonParams.get('arg_separator');\n        var params = $(this).getPostData();\n        params += argSep + 'ajax_request=1' + argSep + 'server=' + CommonParams.get('server');\n        // Get row element of the process to be killed.\n        var $tr = $(this).closest('tr');\n        $.post($(this).attr('href'), params, function (data) {\n            // Check if process was killed or not.\n            if (data.hasOwnProperty('success') && data.success) {\n                // remove the row of killed process.\n                $tr.remove();\n                // As we just removed a row, reapply odd-even classes\n                // to keep table stripes consistent\n                var $tableProcessListTr = $('#tableprocesslist').find('> tbody > tr');\n                $tableProcessListTr.each(function (index) {\n                    if (index >= 0 && index % 2 === 0) {\n                        $(this).removeClass('odd').addClass('even');\n                    }\n                    else if (index >= 0 && index % 2 !== 0) {\n                        $(this).removeClass('even').addClass('odd');\n                    }\n                });\n                // Show process killed message\n                ajaxShowMessage(data.message, false);\n            }\n            else {\n                // Show process error message\n                ajaxShowMessage(data.error, false);\n            }\n        }, 'json');\n    },\n    /**\n     * Handles Auto Refreshing\n     */\n    refresh: function () {\n        // abort any previous pending requests\n        // this is necessary, it may go into\n        // multiple loops causing unnecessary\n        // requests even after leaving the page.\n        processList.abortRefresh();\n        // if auto refresh is enabled\n        if (processList.autoRefresh) {\n            // Only fetch the table contents\n            processList.refreshUrl = 'index.php?route=/server/status/processes/refresh';\n            var interval = parseInt(processList.refreshInterval, 10) * 1000;\n            var urlParams = processList.getUrlParams();\n            processList.refreshRequest = $.post(processList.refreshUrl, urlParams, function (data) {\n                if (data.hasOwnProperty('success') && data.success) {\n                    var $newTable = $(data.message);\n                    $('#tableprocesslist').html($newTable.html());\n                    highlightSql($('#tableprocesslist'));\n                }\n                processList.refreshTimeout = setTimeout(processList.refresh, interval);\n            });\n        }\n    },\n    /**\n     * Stop current request and clears timeout\n     */\n    abortRefresh: function () {\n        if (processList.refreshRequest !== null) {\n            processList.refreshRequest.abort();\n            processList.refreshRequest = null;\n        }\n        clearTimeout(processList.refreshTimeout);\n    },\n    /**\n     * Set label of refresh button\n     * change between play & pause\n     */\n    setRefreshLabel: function () {\n        var img = 'play';\n        var label = window.Messages.strStartRefresh;\n        if (processList.autoRefresh) {\n            img = 'pause';\n            label = window.Messages.strStopRefresh;\n            processList.refresh();\n        }\n        $('a#toggleRefresh').html(getImageTag(img) + escapeHtml(label));\n    },\n    /**\n     * Return the Url Parameters\n     * for autorefresh request,\n     * includes showExecuting if the filter is checked\n     *\n     * @return {object} urlParams - url parameters with autoRefresh request\n     */\n    getUrlParams: function () {\n        var urlParams = {\n            'server': CommonParams.get('server'),\n            'ajax_request': true,\n            'refresh': true,\n            'full': $('input[name=\"full\"]').val(),\n            'order_by_field': $('input[name=\"order_by_field\"]').val(),\n            'column_name': $('input[name=\"column_name\"]').val(),\n            'sort_order': $('input[name=\"sort_order\"]').val()\n        };\n        if ($('#showExecuting').is(':checked')) {\n            urlParams.showExecuting = true;\n            return urlParams;\n        }\n        return urlParams;\n    }\n};\nAJAX.registerOnload('server/status/processes.js', function () {\n    processList.init();\n    // Bind event handler for kill_process\n    $('#tableprocesslist').on('click', 'a.kill_process', processList.killProcessHandler);\n    // Bind event handler for toggling refresh of process list\n    $('a#toggleRefresh').on('click', function (event) {\n        event.preventDefault();\n        processList.autoRefresh = !processList.autoRefresh;\n        processList.setRefreshLabel();\n    });\n    // Bind event handler for change in refresh rate\n    $('#id_refreshRate').on('change', function () {\n        processList.refreshInterval = $(this).val();\n        processList.refresh();\n    });\n    // Bind event handler for table header links\n    $('#tableprocesslist').on('click', 'thead a', function () {\n        processList.refreshUrl = $(this).attr('href');\n    });\n});\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('server/status/processes.js', function () {\n    $('#tableprocesslist').off('click', 'a.kill_process');\n    $('a#toggleRefresh').off('click');\n    $('#id_refreshRate').off('change');\n    $('#tableprocesslist').off('click', 'thead a');\n    // stop refreshing further\n    processList.abortRefresh();\n});\n"],"names":["$","AJAX","CommonParams","highlightSql","ajaxShowMessage","escapeHtml","getImageTag","processList","autoRefresh","refreshRequest","refreshTimeout","refreshInterval","refreshUrl","init","setRefreshLabel","val","killProcessHandler","event","preventDefault","argSep","get","params","getPostData","$tr","closest","post","attr","data","hasOwnProperty","success","remove","$tableProcessListTr","find","each","index","removeClass","addClass","message","error","refresh","abortRefresh","interval","parseInt","urlParams","getUrlParams","$newTable","html","setTimeout","abort","clearTimeout","img","label","window","Messages","strStartRefresh","strStopRefresh","is","showExecuting","registerOnload","on","registerTeardown","off"],"sourceRoot":""}