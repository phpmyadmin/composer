{"version":3,"file":"home.js","mappings":"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","sources":["webpack://phpmyadmin/./resources/js/src/home.ts","webpack://phpmyadmin/./resources/js/src/modules/git-info.ts","webpack://phpmyadmin/external var \"jQuery\""],"sourcesContent":["import { AJAX } from './modules/ajax.ts';\nimport { showGitVersion } from './modules/git-info.ts';\nimport { ThemesManager } from './modules/themes-manager.ts';\nAJAX.registerTeardown('home.js', () => {\n    const themesModal = document.getElementById('themesModal');\n    if (themesModal) {\n        themesModal.removeEventListener('show.bs.modal', ThemesManager.handleEvent);\n    }\n});\nAJAX.registerOnload('home.js', () => {\n    const themesModal = document.getElementById('themesModal');\n    if (themesModal) {\n        themesModal.addEventListener('show.bs.modal', ThemesManager.handleEvent);\n    }\n    showGitVersion();\n});\n","import $ from 'jquery';\nimport { CommonParams } from './common.ts';\nimport { escapeHtml } from './functions/escape.ts';\nconst GitInfo = {\n    /**\n     * Version string to integer conversion.\n     * @param {string} str\n     * @return {number | false}\n     */\n    parseVersionString: str => {\n        if (typeof (str) !== 'string') {\n            return false;\n        }\n        let add = 0;\n        // Parse possible alpha/beta/rc/\n        const state = str.split('-');\n        if (state.length >= 2) {\n            if (state[1].startsWith('rc')) {\n                add = -20 - parseInt(state[1].substring(2), 10);\n            }\n            else if (state[1].startsWith('beta')) {\n                add = -40 - parseInt(state[1].substring(4), 10);\n            }\n            else if (state[1].startsWith('alpha')) {\n                add = -60 - parseInt(state[1].substring(5), 10);\n            }\n            else if (state[1].startsWith('dev')) {\n                /* We don't handle dev, it's git snapshot */\n                add = 0;\n            }\n        }\n        // Parse version\n        const x = str.split('.');\n        // Use 0 for non existing parts\n        const maj = parseInt(x[0], 10) || 0;\n        const min = parseInt(x[1], 10) || 0;\n        const pat = parseInt(x[2], 10) || 0;\n        const hotfix = parseInt(x[3], 10) || 0;\n        return maj * 100000000 + min * 1000000 + pat * 10000 + hotfix * 100 + add;\n    },\n    /**\n     * Indicates current available version on main page.\n     * @param {object} data\n     */\n    currentVersion: data => {\n        if (data && data.version && data.date) {\n            const current = GitInfo.parseVersionString($('span.version').text());\n            const latest = GitInfo.parseVersionString(data.version);\n            if (current === false || latest === false) {\n                return;\n            }\n            const url = 'index.php?route=/url&url=https://www.phpmyadmin.net/files/' + escapeHtml(encodeURIComponent(data.version)) + '/';\n            let versionInformationMessage = document.createElement('span');\n            versionInformationMessage.className = 'latest';\n            const versionInformationMessageLink = document.createElement('a');\n            versionInformationMessageLink.href = url;\n            versionInformationMessageLink.className = 'disableAjax';\n            versionInformationMessageLink.target = '_blank';\n            versionInformationMessageLink.rel = 'noopener noreferrer';\n            const versionInformationMessageLinkText = document.createTextNode(data.version);\n            versionInformationMessageLink.appendChild(versionInformationMessageLinkText);\n            const prefixMessage = document.createTextNode(window.Messages.strLatestAvailable + ' ');\n            versionInformationMessage.appendChild(prefixMessage);\n            versionInformationMessage.appendChild(versionInformationMessageLink);\n            if (latest > current) {\n                const message = window.sprintf(window.Messages.strNewerVersion, escapeHtml(data.version), escapeHtml(data.date));\n                let htmlClass = 'alert alert-primary';\n                if (Math.floor(latest / 10000) === Math.floor(current / 10000)) {\n                    /* Security update */\n                    htmlClass = 'alert alert-danger';\n                }\n                $('#newer_version_notice').remove();\n                const mainContainerDiv = document.createElement('div');\n                mainContainerDiv.id = 'newer_version_notice';\n                mainContainerDiv.className = htmlClass;\n                const mainContainerDivLink = document.createElement('a');\n                mainContainerDivLink.href = url;\n                mainContainerDivLink.className = 'disableAjax';\n                mainContainerDivLink.target = '_blank';\n                mainContainerDivLink.rel = 'noopener noreferrer';\n                const mainContainerDivLinkText = document.createTextNode(message);\n                mainContainerDivLink.appendChild(mainContainerDivLinkText);\n                mainContainerDiv.appendChild(mainContainerDivLink);\n                $('#maincontainer').append($(mainContainerDiv));\n            }\n            let upToDateMessage = null;\n            if (latest === current) {\n                upToDateMessage = document.createTextNode(' (' + window.Messages.strUpToDate + ')');\n            }\n            /* Remove extra whitespace */\n            const versionInfo = $('#li_pma_version').contents().get(2);\n            if (typeof versionInfo !== 'undefined') {\n                versionInfo.textContent = versionInfo.textContent.trim();\n            }\n            const $liPmaVersion = $('#li_pma_version');\n            $liPmaVersion.find('span.latest').remove();\n            if (upToDateMessage !== null) {\n                $liPmaVersion.append($(upToDateMessage));\n            }\n            else {\n                $liPmaVersion.append($(versionInformationMessage));\n            }\n        }\n    },\n    /**\n     * Loads Git revision data from ajax for index.php\n     */\n    displayGitRevision: () => {\n        $('#is_git_revision').remove();\n        $('#li_pma_version_git').remove();\n        $.get('index.php?route=/git-revision', {\n            'server': CommonParams.get('server'),\n            'ajax_request': true,\n            'no_debug': true\n        }).done(function (data) {\n            if (typeof data !== 'undefined' && data.success === true) {\n                $(data.message).insertAfter('#li_pma_version');\n            }\n        }).fail(function () {\n            const gitHashInfoLi = '<li id=\"li_pma_version_git\" class=\"list-group-item\">' + window.Messages.errorLoadingGitInformation + '</li>';\n            $(gitHashInfoLi).insertAfter('#li_pma_version');\n        });\n    },\n    /**\n     * Load version information asynchronously.\n     */\n    loadVersion: () => {\n        if ($('li.jsversioncheck').length === 0) {\n            return;\n        }\n        $.ajax({\n            dataType: 'json',\n            url: 'index.php?route=/version-check',\n            method: 'POST',\n            data: {\n                'server': CommonParams.get('server')\n            },\n            success: GitInfo.currentVersion\n        });\n    }\n};\nexport function showGitVersion() {\n    GitInfo.loadVersion();\n    if ($('#is_git_revision').length === 0) {\n        return;\n    }\n    setTimeout(GitInfo.displayGitRevision, 10);\n}\n","module.exports = jQuery;"],"names":["AJAX","showGitVersion","ThemesManager","registerTeardown","themesModal","document","getElementById","removeEventListener","handleEvent","registerOnload","addEventListener","$","CommonParams","escapeHtml","GitInfo","parseVersionString","str","add","state","split","length","startsWith","parseInt","substring","x","maj","min","pat","hotfix","currentVersion","data","version","date","current","text","latest","url","encodeURIComponent","versionInformationMessage","createElement","className","versionInformationMessageLink","href","target","rel","versionInformationMessageLinkText","createTextNode","appendChild","prefixMessage","window","Messages","strLatestAvailable","message","sprintf","strNewerVersion","htmlClass","Math","floor","remove","mainContainerDiv","id","mainContainerDivLink","mainContainerDivLinkText","append","upToDateMessage","strUpToDate","versionInfo","contents","get","textContent","trim","$liPmaVersion","find","displayGitRevision","done","success","insertAfter","fail","gitHashInfoLi","errorLoadingGitInformation","loadVersion","ajax","dataType","method","setTimeout"],"sourceRoot":""}