{"version":3,"file":"database/events.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./resources/js/src/database/events.ts"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.ts';\nimport { addDatepicker, getSqlEditor, slidingMessage } from '../modules/functions.ts';\nimport { Navigation } from '../modules/navigation.ts';\nimport { ajaxRemoveMessage, ajaxShowMessage } from '../modules/ajax-message.ts';\nimport getJsConfirmCommonParam from '../modules/functions/getJsConfirmCommonParam.ts';\nAJAX.registerTeardown('database/events.js', function () {\n    $(document).off('click', 'a.ajax.add_anchor, a.ajax.edit_anchor');\n    $(document).off('click', 'a.ajax.export_anchor');\n    $(document).off('click', '#bulkActionExportButton');\n    $(document).off('click', 'a.ajax.drop_anchor');\n    $(document).off('click', '#bulkActionDropButton');\n    $(document).off('change', 'select[name=item_type]');\n});\nconst DatabaseEvents = {\n    /**\n     * @var $ajaxDialog Query object containing the reference to the\n     *                  dialog that contains the editor\n     */\n    $ajaxDialog: null,\n    /**\n     * @var syntaxHiglighter Reference to the codemirror editor\n     */\n    syntaxHiglighter: null,\n    /**\n     * Validate editor form fields.\n     *\n     * @return {boolean}\n     */\n    validate: function () {\n        /**\n         * @var $elm a jQuery object containing the reference\n         *           to an element that is being validated\n         */\n        var $elm = null;\n        // Common validation. At the very least the name\n        // and the definition must be provided for an item\n        $elm = $('table.rte_table').last().find('input[name=item_name]');\n        if ($elm.val() === '') {\n            $elm.trigger('focus');\n            alert(window.Messages.strFormEmpty);\n            return false;\n        }\n        $elm = $('table.rte_table').find('textarea[name=item_definition]');\n        if ($elm.val() === '') {\n            if (this.syntaxHiglighter !== null) {\n                this.syntaxHiglighter.focus();\n            }\n            else {\n                $('textarea[name=item_definition]').last().trigger('focus');\n            }\n            alert(window.Messages.strFormEmpty);\n            return false;\n        }\n        // The validation has so far passed, so now\n        // we can validate item-specific fields.\n        return this.validateCustom();\n    },\n    exportDialog: function ($this) {\n        var $msg = ajaxShowMessage();\n        if ($this.attr('id') === 'bulkActionExportButton') {\n            var combined = {\n                success: true,\n                title: window.Messages.strExport,\n                message: '',\n                error: ''\n            };\n            // export anchors of all selected rows\n            var exportAnchors = $('input.checkall:checked').parents('tr').find('.export_anchor');\n            var count = exportAnchors.length;\n            var returnCount = 0;\n            var p = $.when();\n            exportAnchors.each(function () {\n                var h = $(this).attr('href');\n                p = p.then(function () {\n                    return $.get(h, { 'ajax_request': true }, function (data) {\n                        returnCount++;\n                        if (data.success === true) {\n                            combined.message += '\\n' + data.message + '\\n';\n                            if (returnCount === count) {\n                                showExport(combined);\n                            }\n                        }\n                        else {\n                            // complain even if one export is failing\n                            combined.success = false;\n                            combined.error += '\\n' + data.error + '\\n';\n                            if (returnCount === count) {\n                                showExport(combined);\n                            }\n                        }\n                    });\n                });\n            });\n        }\n        else {\n            $.get($this.attr('href'), { 'ajax_request': true }, showExport);\n        }\n        ajaxRemoveMessage($msg);\n        function showExport(data) {\n            if (data.success !== true) {\n                ajaxShowMessage(data.error, false);\n                return;\n            }\n            ajaxRemoveMessage($msg);\n            /**\n             * @var buttonOptions Object containing options\n             *                     for jQueryUI dialog buttons\n             */\n            var buttonOptions = {\n                [window.Messages.strClose]: {\n                    text: window.Messages.strClose,\n                    class: 'btn btn-primary',\n                    click: function () {\n                        $(this).dialog('close').remove();\n                    },\n                },\n            };\n            /**\n             * Display the dialog to the user\n             */\n            data.message = '<textarea cols=\"40\" rows=\"15\" class=\"w-100\">' + data.message + '</textarea>';\n            var $ajaxDialog = $('<div>' + data.message + '</div>').dialog({\n                classes: {\n                    'ui-dialog-titlebar-close': 'btn-close'\n                },\n                width: 500,\n                // @ts-ignore\n                buttons: buttonOptions,\n                title: data.title\n            });\n            // Attach syntax highlighted editor to export dialog\n            /**\n             * @var $elm jQuery object containing the reference\n             *           to the Export textarea.\n             */\n            var $elm = $ajaxDialog.find('textarea');\n            getSqlEditor($elm);\n        } // end showExport()\n    }, // end exportDialog()\n    editorDialog: function (isNew, $this) {\n        var that = this;\n        /**\n         * @var $edit_row jQuery object containing the reference to\n         *                the row of the the item being edited\n         *                from the list of items\n         */\n        var $editRow = null;\n        if ($this.hasClass('edit_anchor')) {\n            // Remember the row of the item being edited for later,\n            // so that if the edit is successful, we can replace the\n            // row with info about the modified item.\n            $editRow = $this.parents('tr');\n        }\n        /**\n         * @var $msg jQuery object containing the reference to\n         *           the AJAX message shown to the user\n         */\n        var $msg = ajaxShowMessage();\n        $.get($this.attr('href'), { 'ajax_request': true }, function (data) {\n            if (data.success !== true) {\n                ajaxShowMessage(data.error, false);\n                return;\n            }\n            // We have successfully fetched the editor form\n            ajaxRemoveMessage($msg);\n            /**\n             * @var buttonOptions Object containing options\n             *                     for jQueryUI dialog buttons\n             */\n            var buttonOptions = {\n                [window.Messages.strGo]: {\n                    text: window.Messages.strGo,\n                    class: 'btn btn-primary',\n                },\n                [window.Messages.strClose]: {\n                    text: window.Messages.strClose,\n                    class: 'btn btn-secondary',\n                },\n            };\n            // Now define the function that is called when\n            // the user presses the \"Go\" button\n            // @ts-ignore\n            buttonOptions[window.Messages.strGo].click = function () {\n                // Move the data from the codemirror editor back to the\n                // textarea, where it can be used in the form submission.\n                if (typeof window.CodeMirror !== 'undefined') {\n                    that.syntaxHiglighter.save();\n                }\n                // Validate editor and submit request, if passed.\n                if (that.validate()) {\n                    /**\n                     * @var data Form data to be sent in the AJAX request\n                     */\n                    var data = $('form.rte_form').last().serialize();\n                    $msg = ajaxShowMessage(window.Messages.strProcessingRequest);\n                    var url = $('form.rte_form').last().attr('action');\n                    $.post(url, data, function (data) {\n                        if (data.success !== true) {\n                            ajaxShowMessage(data.error, false);\n                            return;\n                        }\n                        // Item created successfully\n                        ajaxRemoveMessage($msg);\n                        slidingMessage(data.message);\n                        that.$ajaxDialog.dialog('close');\n                        // If we are in 'edit' mode, we must\n                        // remove the reference to the old row.\n                        if (mode === 'edit' && $editRow !== null) {\n                            $editRow.remove();\n                        }\n                        // Sometimes, like when moving a trigger from\n                        // a table to another one, the new row should\n                        // not be inserted into the list. In this case\n                        // \"data.insert\" will be set to false.\n                        if (data.insert) {\n                            // Insert the new row at the correct\n                            // location in the list of items\n                            /**\n                             * @var text Contains the name of an item from\n                             *           the list that is used in comparisons\n                             *           to find the correct location where\n                             *           to insert a new row.\n                             */\n                            var text = '';\n                            /**\n                             * @var inserted Whether a new item has been\n                             *               inserted in the list or not\n                             */\n                            var inserted = false;\n                            $('table.data').find('tr').each(function () {\n                                text = $(this)\n                                    .children('td')\n                                    .eq(0)\n                                    .find('strong')\n                                    .text()\n                                    .toUpperCase()\n                                    .trim();\n                                if (text !== '' && text > data.name) {\n                                    $(this).before(data.new_row);\n                                    inserted = true;\n                                    return false;\n                                }\n                            });\n                            if (!inserted) {\n                                // If we didn't manage to insert the row yet,\n                                // it must belong at the end of the list,\n                                // so we insert it there.\n                                $('table.data').append(data.new_row);\n                            }\n                            // Fade-in the new row\n                            $('tr.ajaxInsert')\n                                .show('slow')\n                                .removeClass('ajaxInsert');\n                        }\n                        else if ($('table.data').find('tr').has('td').length === 0) {\n                            // If we are not supposed to insert the new row,\n                            // we will now check if the table is empty and\n                            // needs to be hidden. This will be the case if\n                            // we were editing the only item in the list,\n                            // which we removed and will not be inserting\n                            // something else in its place.\n                            $('table.data').hide('slow', function () {\n                                $('#nothing2display').show('slow');\n                            });\n                        }\n                        // Now we have inserted the row at the correct\n                        // position, but surely at least some row classes\n                        // are wrong now. So we will iterate through\n                        // all rows and assign correct classes to them\n                        /**\n                         * @var ct Count of processed rows\n                         */\n                        var ct = 0;\n                        /**\n                         * @var rowclass Class to be attached to the row\n                         *               that is being processed\n                         */\n                        var rowclass = '';\n                        $('table.data').find('tr').has('td').each(function () {\n                            rowclass = (ct % 2 === 0) ? 'odd' : 'even';\n                            $(this).removeClass().addClass(rowclass);\n                            ct++;\n                        });\n                        // If this is the first item being added, remove\n                        // the \"No items\" message and show the list.\n                        if ($('table.data').find('tr').has('td').length > 0 &&\n                            $('#nothing2display').is(':visible')) {\n                            $('#nothing2display').hide('slow', function () {\n                                $('table.data').show('slow');\n                            });\n                        }\n                        Navigation.reload();\n                    }); // end $.post()\n                } // end \"if (that.validate())\"\n            }; // end of function that handles the submission of the Editor\n            // @ts-ignore\n            buttonOptions[window.Messages.strClose].click = function () {\n                $(this).dialog('close');\n            };\n            /**\n             * Display the dialog to the user\n             */\n            that.$ajaxDialog = $('<div id=\"rteDialog\">' + data.message + '</div>').dialog({\n                classes: {\n                    'ui-dialog-titlebar-close': 'btn-close'\n                },\n                height: 500,\n                width: '70%',\n                minWidth: 500,\n                // @ts-ignore\n                buttons: buttonOptions,\n                // Issue #15810 - use button titles for modals (eg: new procedure)\n                // Respect the order: title on href tag, href content, title sent in response\n                title: $this.attr('title') || $this.text() || $(data.title).text(),\n                modal: true,\n                open: function () {\n                    $('#rteDialog').dialog('option', 'max-height', $(window).height());\n                    if ($('#rteDialog').parents('.ui-dialog').height() > $(window).height()) {\n                        $('#rteDialog').dialog('option', 'height', $(window).height());\n                    }\n                    $(this).find('input[name=item_name]').trigger('focus');\n                    $(this).find('input.datefield').each(function () {\n                        addDatepicker($(this).css('width', '95%'), 'date');\n                    });\n                    $(this).find('input.datetimefield').each(function () {\n                        addDatepicker($(this).css('width', '95%'), 'datetime');\n                    });\n                    // @ts-ignore\n                    $.datepicker.initialized = false;\n                },\n                close: function () {\n                    $(this).remove();\n                }\n            });\n            /**\n             * @var mode Used to remember whether the editor is in\n             *           \"Edit\" or \"Add\" mode\n             */\n            var mode = 'add';\n            if ($('input[name=editor_process_edit]').length > 0) {\n                mode = 'edit';\n            }\n            // Attach syntax highlighted editor to the definition\n            /**\n             * @var elm jQuery object containing the reference to\n             *                 the Definition textarea.\n             */\n            var $elm = $('textarea[name=item_definition]').last();\n            var linterOptions = {\n                editorType: 'event',\n            };\n            that.syntaxHiglighter = getSqlEditor($elm, {}, 'vertical', linterOptions);\n            window.codeMirrorEditor = that.syntaxHiglighter;\n        }); // end $.get()\n    },\n    dropDialog: function ($this) {\n        /**\n         * @var $curr_row Object containing reference to the current row\n         */\n        var $currRow = $this.parents('tr');\n        /**\n         * @var question String containing the question to be asked for confirmation\n         */\n        var question = $('<div></div>').text($currRow.children('td').children('.drop_sql').html());\n        // We ask for confirmation first here, before submitting the ajax request\n        $this.confirm(question, $this.attr('href'), function (url) {\n            /**\n             * @var msg jQuery object containing the reference to\n             *          the AJAX message shown to the user\n             */\n            var $msg = ajaxShowMessage(window.Messages.strProcessingRequest);\n            var params = getJsConfirmCommonParam(this, $this.getPostData());\n            $.post(url, params, function (data) {\n                if (data.success !== true) {\n                    ajaxShowMessage(data.error, false);\n                    return;\n                }\n                /**\n                 * @var $table Object containing reference\n                 *             to the main list of elements\n                 */\n                var $table = $currRow.parent();\n                // Check how many rows will be left after we remove\n                // the one that the user has requested us to remove\n                if ($table.find('tr').length === 3) {\n                    // If there are two rows left, it means that they are\n                    // the header of the table and the rows that we are\n                    // about to remove, so after the removal there will be\n                    // nothing to show in the table, so we hide it.\n                    $table.hide('slow', function () {\n                        $(this).find('tr.even, tr.odd').remove();\n                        $('.withSelected').remove();\n                        $('#nothing2display').show('slow');\n                    });\n                }\n                else {\n                    $currRow.hide('slow', function () {\n                        $(this).remove();\n                        // Now we have removed the row from the list, but maybe\n                        // some row classes are wrong now. So we will iterate\n                        // through all rows and assign correct classes to them.\n                        /**\n                         * @var ct Count of processed rows\n                         */\n                        var ct = 0;\n                        /**\n                         * @var rowclass Class to be attached to the row\n                         *               that is being processed\n                         */\n                        var rowclass = '';\n                        $table.find('tr').has('td').each(function () {\n                            rowclass = (ct % 2 === 1) ? 'odd' : 'even';\n                            $(this).removeClass().addClass(rowclass);\n                            ct++;\n                        });\n                    });\n                }\n                // Get rid of the \"Loading\" message\n                ajaxRemoveMessage($msg);\n                // Show the query that we just executed\n                slidingMessage(data.sql_query);\n                Navigation.reload();\n            }); // end $.post()\n        });\n    },\n    dropMultipleDialog: function ($this) {\n        // We ask for confirmation here\n        $this.confirm(window.Messages.strDropRTEitems, '', function () {\n            /**\n             * @var msg jQuery object containing the reference to\n             *          the AJAX message shown to the user\n             */\n            var $msg = ajaxShowMessage(window.Messages.strProcessingRequest);\n            // drop anchors of all selected rows\n            var dropAnchors = $('input.checkall:checked').parents('tr').find('.drop_anchor');\n            var success = true;\n            var count = dropAnchors.length;\n            var returnCount = 0;\n            dropAnchors.each(function () {\n                var $anchor = $(this);\n                /**\n                 * @var $curr_row Object containing reference to the current row\n                 */\n                var $currRow = $anchor.parents('tr');\n                var params = getJsConfirmCommonParam(this, $anchor.getPostData());\n                $.post($anchor.attr('href'), params, function (data) {\n                    returnCount++;\n                    if (data.success !== true) {\n                        ajaxShowMessage(data.error, false);\n                        success = false;\n                        if (returnCount === count) {\n                            Navigation.reload();\n                        }\n                        return;\n                    }\n                    /**\n                     * @var $table Object containing reference\n                     *             to the main list of elements\n                     */\n                    var $table = $currRow.parent();\n                    // Check how many rows will be left after we remove\n                    // the one that the user has requested us to remove\n                    if ($table.find('tr').length === 3) {\n                        // If there are two rows left, it means that they are\n                        // the header of the table and the rows that we are\n                        // about to remove, so after the removal there will be\n                        // nothing to show in the table, so we hide it.\n                        $table.hide('slow', function () {\n                            $(this).find('tr.even, tr.odd').remove();\n                            $('.withSelected').remove();\n                            $('#nothing2display').show('slow');\n                        });\n                    }\n                    else {\n                        $currRow.hide('fast', function () {\n                            // we will iterate\n                            // through all rows and assign correct classes to them.\n                            /**\n                             * @var ct Count of processed rows\n                             */\n                            var ct = 0;\n                            /**\n                             * @var rowclass Class to be attached to the row\n                             *               that is being processed\n                             */\n                            var rowclass = '';\n                            $table.find('tr').has('td').each(function () {\n                                rowclass = (ct % 2 === 1) ? 'odd' : 'even';\n                                $(this).removeClass().addClass(rowclass);\n                                ct++;\n                            });\n                        });\n                        $currRow.remove();\n                    }\n                    if (returnCount === count) {\n                        if (success) {\n                            // Get rid of the \"Loading\" message\n                            ajaxRemoveMessage($msg);\n                            $('#rteListForm_checkall').prop({ checked: false, indeterminate: false });\n                        }\n                        Navigation.reload();\n                    }\n                }); // end $.post()\n            }); // end drop_anchors.each()\n        });\n    },\n    /**\n     * Validate custom editor form fields.\n     *\n     * @return {boolean}\n     */\n    validateCustom: function () {\n        /**\n         * @var elm a jQuery object containing the reference\n         *          to an element that is being validated\n         */\n        var $elm = null;\n        if (this.$ajaxDialog.find('select[name=item_type]').find(':selected').val() === 'RECURRING') {\n            // The interval field must not be empty for recurring events\n            $elm = this.$ajaxDialog.find('input[name=item_interval_value]');\n            if ($elm.val() === '') {\n                $elm.trigger('focus');\n                alert(window.Messages.strFormEmpty);\n                return false;\n            }\n        }\n        else {\n            // The execute_at field must not be empty for \"once off\" events\n            $elm = this.$ajaxDialog.find('input[name=item_execute_at]');\n            if ($elm.val() === '') {\n                $elm.trigger('focus');\n                alert(window.Messages.strFormEmpty);\n                return false;\n            }\n        }\n        return true;\n    }\n};\nAJAX.registerOnload('database/events.js', function () {\n    /**\n     * Attach Ajax event handlers for the Add/Edit functionality.\n     */\n    $(document).on('click', 'a.ajax.add_anchor, a.ajax.edit_anchor', function (event) {\n        event.preventDefault();\n        if ($(this).hasClass('add_anchor')) {\n            // @ts-ignore\n            $.datepicker.initialized = false;\n        }\n        DatabaseEvents.editorDialog($(this).hasClass('add_anchor'), $(this));\n    });\n    /**\n     * Attach Ajax event handlers for Export\n     */\n    $(document).on('click', 'a.ajax.export_anchor', function (event) {\n        event.preventDefault();\n        DatabaseEvents.exportDialog($(this));\n    }); // end $(document).on()\n    $(document).on('click', '#bulkActionExportButton', function (event) {\n        event.preventDefault();\n        DatabaseEvents.exportDialog($(this));\n    }); // end $(document).on()\n    /**\n     * Attach Ajax event handlers for Drop functionality\n     */\n    $(document).on('click', 'a.ajax.drop_anchor', function (event) {\n        event.preventDefault();\n        DatabaseEvents.dropDialog($(this));\n    }); // end $(document).on()\n    $(document).on('click', '#bulkActionDropButton', function (event) {\n        event.preventDefault();\n        DatabaseEvents.dropMultipleDialog($(this));\n    }); // end $(document).on()\n    /**\n     * Attach Ajax event handlers for the \"Change event type\" functionality, so that the correct\n     * rows are shown in the editor when changing the event type\n     */\n    $(document).on('change', 'select[name=item_type]', function () {\n        $(this).closest('table').find('tr.recurring_event_row, tr.onetime_event_row').toggle();\n    });\n});\n"],"names":["$","AJAX","addDatepicker","getSqlEditor","slidingMessage","Navigation","ajaxRemoveMessage","ajaxShowMessage","getJsConfirmCommonParam","registerTeardown","document","off","DatabaseEvents","$ajaxDialog","syntaxHiglighter","validate","$elm","last","find","val","trigger","alert","window","Messages","strFormEmpty","focus","validateCustom","exportDialog","$this","$msg","attr","combined","success","title","strExport","message","error","exportAnchors","parents","count","length","returnCount","p","when","each","h","then","get","data","showExport","buttonOptions","strClose","text","class","click","dialog","remove","classes","width","buttons","editorDialog","isNew","that","$editRow","hasClass","strGo","CodeMirror","save","serialize","strProcessingRequest","url","post","mode","insert","inserted","children","eq","toUpperCase","trim","name","before","new_row","append","show","removeClass","has","hide","ct","rowclass","addClass","is","reload","height","minWidth","modal","open","css","datepicker","initialized","close","linterOptions","editorType","codeMirrorEditor","dropDialog","$currRow","question","html","confirm","params","getPostData","$table","parent","sql_query","dropMultipleDialog","strDropRTEitems","dropAnchors","$anchor","prop","checked","indeterminate","registerOnload","on","event","preventDefault","closest","toggle"],"sourceRoot":""}