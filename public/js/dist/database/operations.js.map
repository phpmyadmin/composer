{"version":3,"file":"database/operations.js","mappings":"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","sources":["webpack://phpmyadmin/external var \"jQuery\"","webpack://phpmyadmin/./resources/js/src/database/operations.ts"],"sourcesContent":["module.exports = jQuery;","import $ from 'jquery';\nimport { AJAX } from '../modules/ajax.ts';\nimport { emptyCheckTheField, prepareForAjaxRequest } from '../modules/functions.ts';\nimport { Navigation } from '../modules/navigation.ts';\nimport { CommonParams } from '../modules/common.ts';\nimport { ajaxShowMessage } from '../modules/ajax-message.ts';\nimport getJsConfirmCommonParam from '../modules/functions/getJsConfirmCommonParam.ts';\nimport { escapeHtml } from '../modules/functions/escape.ts';\nimport refreshMainContent from '../modules/functions/refreshMainContent.ts';\n/**\n * @fileoverview    function used in server privilege pages\n * @name            Database Operations\n *\n * @requires    jQueryUI\n */\n/**\n * Ajax event handlers here for /database/operations\n *\n * Actions Ajaxified here:\n * Rename Database\n * Copy Database\n * Change Charset\n * Drop Database\n */\n/**\n * Unbind all event handlers before tearing down a page\n */\nAJAX.registerTeardown('database/operations.js', function () {\n    $(document).off('submit', '#rename_db_form.ajax');\n    $(document).off('submit', '#copy_db_form.ajax');\n    $(document).off('submit', '#change_db_charset_form.ajax');\n    $(document).off('click', '#drop_db_anchor.ajax');\n});\nAJAX.registerOnload('database/operations.js', function () {\n    /**\n     * Ajax event handlers for 'Rename Database'\n     */\n    $(document).on('submit', '#rename_db_form.ajax', function (event) {\n        event.preventDefault();\n        if (emptyCheckTheField(this, 'newname')) {\n            ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n        var oldDbName = CommonParams.get('db');\n        var newDbName = $('#new_db_name').val();\n        if (newDbName === oldDbName) {\n            ajaxShowMessage(window.Messages.strDatabaseRenameToSameName, false, 'error');\n            return false;\n        }\n        var $form = $(this);\n        var question = escapeHtml('CREATE DATABASE ' + newDbName + ' / DROP DATABASE ' + oldDbName);\n        prepareForAjaxRequest($form);\n        $form.confirm(question, $form.attr('action'), function (url) {\n            ajaxShowMessage(window.Messages.strRenamingDatabases, false);\n            $.post(url, $('#rename_db_form').serialize() + CommonParams.get('arg_separator') + 'is_js_confirmed=1', function (data) {\n                if (typeof data !== 'undefined' && data.success === true) {\n                    ajaxShowMessage(data.message);\n                    Navigation.update(CommonParams.set('db', data.newname));\n                    Navigation.reload(function () {\n                        $('#pma_navigation_tree')\n                            .find('a:not(\\'.expander\\')')\n                            .each(function () {\n                            var $thisAnchor = $(this);\n                            if ($thisAnchor.text() === data.newname) {\n                                // simulate a click on the new db name\n                                // in navigation\n                                $thisAnchor.trigger('click');\n                            }\n                        });\n                    });\n                }\n                else {\n                    ajaxShowMessage(data.error, false);\n                }\n            }); // end $.post()\n        });\n    }); // end Rename Database\n    /**\n     * Ajax Event Handler for 'Copy Database'\n     */\n    $(document).on('submit', '#copy_db_form.ajax', function (event) {\n        event.preventDefault();\n        if (emptyCheckTheField(this, 'newname')) {\n            ajaxShowMessage(window.Messages.strFormEmpty, false, 'error');\n            return false;\n        }\n        ajaxShowMessage(window.Messages.strCopyingDatabase, false);\n        var $form = $(this);\n        prepareForAjaxRequest($form);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            // use messages that stay on screen\n            $('.alert-success, .alert-danger').fadeOut();\n            if (typeof data !== 'undefined' && data.success === true) {\n                if ($('#checkbox_switch').is(':checked')) {\n                    Navigation.update(CommonParams.set('db', data.newname));\n                    refreshMainContent(false);\n                    AJAX.callback = () => {\n                        ajaxShowMessage(data.message);\n                    };\n                }\n                else {\n                    Navigation.update(CommonParams.set('db', data.db));\n                    ajaxShowMessage(data.message);\n                }\n                Navigation.reload();\n            }\n            else {\n                ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end copy database\n    /**\n     * Change tables columns visible only if change tables is checked\n     */\n    $('#span_change_all_tables_columns_collations').hide();\n    $('#checkbox_change_all_tables_collations').on('click', function () {\n        $('#span_change_all_tables_columns_collations').toggle();\n    });\n    /**\n     * Ajax Event handler for 'Change Charset' of the database\n     */\n    $(document).on('submit', '#change_db_charset_form.ajax', function (event) {\n        event.preventDefault();\n        var $form = $(this);\n        prepareForAjaxRequest($form);\n        ajaxShowMessage(window.Messages.strChangingCharset);\n        $.post($form.attr('action'), $form.serialize(), function (data) {\n            if (typeof data !== 'undefined' && data.success === true) {\n                ajaxShowMessage(data.message);\n            }\n            else {\n                ajaxShowMessage(data.error, false);\n            }\n        }); // end $.post()\n    }); // end change charset\n    /**\n     * Ajax event handlers for Drop Database\n     */\n    $(document).on('click', '#drop_db_anchor.ajax', function (event) {\n        event.preventDefault();\n        var $link = $(this);\n        /**\n         * @var {string} question String containing the question to be asked for confirmation\n         */\n        var question = window.Messages.strDropDatabaseStrongWarning + ' ';\n        question += window.sprintf(window.Messages.strDoYouReally, 'DROP DATABASE `' + escapeHtml(CommonParams.get('db') + '`'));\n        var params = getJsConfirmCommonParam(this, $link.getPostData());\n        $(this).confirm(question, $(this).attr('href'), function (url) {\n            ajaxShowMessage(window.Messages.strProcessingRequest);\n            $.post(url, params, function (data) {\n                if (typeof data !== 'undefined' && data.success) {\n                    // Database deleted successfully, refresh both the frames\n                    Navigation.reload();\n                    Navigation.update(CommonParams.set('db', ''));\n                    refreshMainContent('index.php?route=/server/databases');\n                    AJAX.callback = () => {\n                        ajaxShowMessage(data.message);\n                    };\n                }\n                else {\n                    ajaxShowMessage(data.error, false);\n                }\n            });\n        });\n    });\n});\n"],"names":["$","AJAX","emptyCheckTheField","prepareForAjaxRequest","Navigation","CommonParams","ajaxShowMessage","getJsConfirmCommonParam","escapeHtml","refreshMainContent","registerTeardown","document","off","registerOnload","on","event","preventDefault","window","Messages","strFormEmpty","oldDbName","get","newDbName","val","strDatabaseRenameToSameName","$form","question","confirm","attr","url","strRenamingDatabases","post","serialize","data","success","message","update","set","newname","reload","find","each","$thisAnchor","text","trigger","error","strCopyingDatabase","fadeOut","is","callback","db","hide","toggle","strChangingCharset","$link","strDropDatabaseStrongWarning","sprintf","strDoYouReally","params","getPostData","strProcessingRequest"],"sourceRoot":""}